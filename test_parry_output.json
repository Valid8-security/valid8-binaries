{
  "scan_id": "7d89deb25333",
  "timestamp": "2025-11-04T05:05:27.038850",
  "target": "examples/test_extended_cwes.py",
  "summary": {
    "files_scanned": 1,
    "vulnerabilities_found": 37,
    "by_severity": {
      "critical": 8,
      "high": 23,
      "medium": 4,
      "CRITICAL": 2
    },
    "by_cwe": {
      "CWE-78": 2,
      "CWE-306": 2,
      "CWE-434": 5,
      "CWE-113": 2,
      "CWE-330": 2,
      "CWE-295": 3,
      "CWE-321": 2,
      "CWE-311": 2,
      "CWE-319": 2,
      "CWE-614": 2,
      "CWE-287": 4,
      "CWE-352": 5,
      "CWE-94": 2,
      "CWE-863": 2
    }
  },
  "vulnerabilities": [
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "OS Command Injection",
      "description": "Potential command injection using eval. User input should never be passed directly to system commands.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 56,
      "code_snippet": "def dangerous_eval():",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "OS Command Injection",
      "description": "Potential command injection using eval. User input should never be passed directly to system commands.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 58,
      "code_snippet": "return eval(code)  # Dangerous method",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-306",
      "severity": "critical",
      "title": "Missing Authentication",
      "description": "Critical function \"delete\" has no authentication. Add @login_required or similar decorator.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 37,
      "code_snippet": "def delete_user(user_id):",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-306",
      "severity": "critical",
      "title": "Missing Authentication",
      "description": "Critical function \"sudo\" has no authentication. Add @login_required or similar decorator.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 41,
      "code_snippet": "def sudo_command(cmd):",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-434",
      "severity": "high",
      "title": "Unrestricted File Upload",
      "description": "File upload without type validation. Restrict file types to whitelist only.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 46,
      "code_snippet": "def upload_file(file):",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-434",
      "severity": "high",
      "title": "Unrestricted File Upload",
      "description": "File upload without type validation. Restrict file types to whitelist only.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 49,
      "code_snippet": "f.write(file.read())  # No validation",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-434",
      "severity": "high",
      "title": "Unrestricted File Upload",
      "description": "File upload without type validation. Restrict file types to whitelist only.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 51,
      "code_snippet": "def save_uploaded(file):",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-434",
      "severity": "high",
      "title": "Unrestricted File Upload",
      "description": "File upload without type validation. Restrict file types to whitelist only.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 53,
      "code_snippet": "file.save(\"/tmp/uploads.bin\")",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-434",
      "severity": "high",
      "title": "Unrestricted File Upload",
      "description": "File upload without type validation. Restrict file types to whitelist only.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 161,
      "code_snippet": "f.write(data)  # No locking on shared resource",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-113",
      "severity": "high",
      "title": "HTTP Header Injection",
      "description": "User-controlled input in HTTP headers. Sanitize or escape CRLF sequences.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 72,
      "code_snippet": "def set_header(response, request):",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-113",
      "severity": "high",
      "title": "HTTP Header Injection",
      "description": "User-controlled input in HTTP headers. Sanitize or escape CRLF sequences.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 74,
      "code_snippet": "response['Location'] = request.GET.get('redirect', '')  # No validation",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-330",
      "severity": "medium",
      "title": "Insufficient Random Values",
      "description": "Use random.choice()/randint() for cryptographic operations. Use secrets module instead.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 86,
      "code_snippet": "return random.choice('abcdefghijklmnop')  # Should use secrets module",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-330",
      "severity": "medium",
      "title": "Insufficient Random Values",
      "description": "Use random.choice()/randint() for cryptographic operations. Use secrets module instead.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 91,
      "code_snippet": "session_key = random.randint(1, 1000)  # Weak for security",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-295",
      "severity": "high",
      "title": "Improper Certificate Validation",
      "description": "SSL/TLS certificate verification disabled. Always verify certificates.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 97,
      "code_snippet": "requests.get('https://example.com', verify=False)  # Dangerous!",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-295",
      "severity": "high",
      "title": "Improper Certificate Validation",
      "description": "SSL/TLS certificate verification disabled. Always verify certificates.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 100,
      "code_snippet": "\"\"\"Another verify=False\"\"\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-295",
      "severity": "high",
      "title": "Improper Certificate Validation",
      "description": "SSL/TLS certificate verification disabled. Always verify certificates.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 102,
      "code_snippet": "context = ssl._create_unverified_context()",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-321",
      "severity": "critical",
      "title": "Hard-coded Cryptographic Key",
      "description": "Hard-coded key detected. Use environment variables or key management.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 107,
      "code_snippet": "key = \"my_secret_key_12345abcdefgh\"  # Should use environment",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-321",
      "severity": "critical",
      "title": "Hard-coded Cryptographic Key",
      "description": "Hard-coded SECRET_KEY detected. Use environment variables or key management.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 112,
      "code_snippet": "SECRET_KEY = \"django-insecure-secret-key-here\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 79,
      "code_snippet": "error = \"Database connection failed: password=secret123\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 122,
      "code_snippet": "api_key = key",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-319",
      "severity": "high",
      "title": "Cleartext Transmission",
      "description": "HTTP used instead of HTTPS. Sensitive data transmitted without encryption.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 127,
      "code_snippet": "requests.post('http://api.example.com/login',",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-319",
      "severity": "high",
      "title": "Cleartext Transmission",
      "description": "HTTP used instead of HTTPS. Sensitive data transmitted without encryption.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 132,
      "code_snippet": "return requests.get('http://example.com/data')",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-614",
      "severity": "medium",
      "title": "Insecure Cookie",
      "description": "Cookie without Secure or HttpOnly flags. Add secure=True and httponly=True.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 178,
      "code_snippet": "response.set_cookie('session', value)  # Missing flags",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-614",
      "severity": "medium",
      "title": "Insecure Cookie",
      "description": "Cookie without Secure or HttpOnly flags. Add secure=True and httponly=True.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 182,
      "code_snippet": "response.set_cookie('user_data', 'some_value')",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 120,
      "code_snippet": "def save_api_key(key):",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 121,
      "code_snippet": "\"\"\"API key in plaintext\"\"\"",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 122,
      "code_snippet": "api_key = key",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 127,
      "code_snippet": "requests.post('http://api.example.com/login',",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 37,
      "code_snippet": "def delete_user(user_id):",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 88,
      "code_snippet": "def create_session_id():",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 102,
      "code_snippet": "context = ssl._create_unverified_context()",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 127,
      "code_snippet": "requests.post('http://api.example.com/login',",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 180,
      "code_snippet": "def create_cookie(response):",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-94",
      "severity": "critical",
      "title": "Code Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before code injection.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 56,
      "code_snippet": "\n# CWE-749: Exposed Dangerous Method (would need Flask context but testing pattern)\ndef dangerous_eval():\n    code = \"print('hello')\"\n    return eval(code)  # Dangerous method",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-94",
      "severity": "critical",
      "title": "Code Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before code injection.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 58,
      "code_snippet": "def dangerous_eval():\n    code = \"print('hello')\"\n    return eval(code)  # Dangerous method\n\n# CWE-770: Resource Exhaustion",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-863",
      "severity": "CRITICAL",
      "title": "Missing Authorization Check",
      "description": "Sensitive operation (delete/update/admin) without visible authorization check.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 33,
      "code_snippet": "def admin_panel():",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-863",
      "severity": "CRITICAL",
      "title": "Missing Authorization Check",
      "description": "Sensitive operation (delete/update/admin) without visible authorization check.",
      "file_path": "examples/test_extended_cwes.py",
      "line_number": 37,
      "code_snippet": "def delete_user(user_id):",
      "confidence": "high",
      "category": "security",
      "language": "python"
    }
  ]
}