flowchart TD
    subgraph "Input Sources"
        CLI[CLI Commands<br/>parry scan .]
        API[REST API<br/>POST /api/v1/scan]
        Webhook[Webhooks<br/>GitHub/GitLab]
        IDE[IDE Plugins<br/>VS Code Extension]
    end

    subgraph "Discovery & Filtering"
        Discover[File Discovery<br/>Walk codebase]
        Prefilter[Pre-filtering<br/>Binary/text detection]
        Prioritize[Smart Prioritization<br/>Risk-based selection]
        Exclude[Exclusion Rules<br/>gitignore patterns]
    end

    subgraph "Parallel Processing"
        Pattern[Pattern Scan<br/>Regex matching<br/>ThreadPool]
        AI[AI Analysis<br/>LLM validation<br/>Batch processing]
        Custom[Custom Rules<br/>YAML patterns]
    end

    subgraph "Validation & Reduction"
        Validate[AI Validation<br/>False positive reduction]
        NL[NL SLM Filter<br/>Natural language rules]
        Confidence[Confidence Scoring<br/>Multi-dimensional]
    end

    subgraph "Output Generation"
        JSON[JSON Output<br/>Structured results]
        SARIF[SARIF Format<br/>GitHub Security tab]
        HTML[HTML Dashboard<br/>Interactive reports]
        Terminal[Terminal Display<br/>Rich formatting]
    end

    CLI --> Discover
    API --> Discover
    Webhook --> Discover
    IDE --> Discover

    Discover --> Prefilter
    Prefilter --> Prioritize
    Prioritize --> Exclude

    Exclude --> Pattern
    Exclude --> AI
    Exclude --> Custom

    Pattern --> Validate
    AI --> Validate
    Custom --> Validate

    Validate --> NL
    NL --> Confidence

    Confidence --> JSON
    Confidence --> SARIF
    Confidence --> HTML
    Confidence --> Terminal

    style CLI fill:#e3f2fd
    style Pattern fill:#f3e5f5
    style AI fill:#e8f5e8
    style Validate fill:#fff3e0
    style NL fill:#fce4ec
