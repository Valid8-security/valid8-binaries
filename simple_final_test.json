{
  "scan_id": "71c3833aa381",
  "timestamp": "2025-11-04T15:07:10.715586",
  "target": "examples/vulnerable_code.py",
  "summary": {
    "files_scanned": 1,
    "vulnerabilities_found": 33,
    "by_severity": {
      "critical": 6,
      "medium": 3,
      "high": 24
    },
    "by_cwe": {
      "CWE-78": 1,
      "CWE-327": 1,
      "CWE-798": 2,
      "CWE-259": 1,
      "CWE-502": 1,
      "CWE-732": 1,
      "CWE-434": 1,
      "CWE-311": 2,
      "CWE-287": 7,
      "CWE-352": 2,
      "CWE-89": 1,
      "CWE-489": 1,
      "CWE-319": 1,
      "918": 1,
      "732": 1,
      "78": 1,
      "22": 1,
      "502": 1,
      "798": 2,
      "89": 1,
      "79": 3
    }
  },
  "vulnerabilities": [
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "OS Command Injection",
      "description": "Potential command injection using os.system. User input should never be passed directly to system commands.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 42,
      "code_snippet": "result = os.system(f\"ping -c 1 {host}\")",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-327",
      "severity": "medium",
      "title": "Weak Cryptographic Algorithm",
      "description": "Use of weak cryptographic algorithm MD5. Use SHA-256 or stronger.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 63,
      "code_snippet": "return hashlib.md5(password.encode()).hexdigest()",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-798",
      "severity": "critical",
      "title": "Hardcoded Credentials",
      "description": "Hardcoded password detected. Store credentials in environment variables.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 16,
      "code_snippet": "DATABASE_PASSWORD = \"supersecret123\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-798",
      "severity": "critical",
      "title": "Hardcoded Credentials",
      "description": "Hardcoded API key detected. Store credentials in environment variables.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 17,
      "code_snippet": "API_KEY = \"sk-1234567890abcdefghijklmnop\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-259",
      "severity": "critical",
      "title": "Hard-coded Password",
      "description": "Environment password. Store passwords securely, never hard-code them.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 16,
      "code_snippet": "DATABASE_PASSWORD = \"supersecret123\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-502",
      "severity": "high",
      "title": "Unsafe Deserialization",
      "description": "Unsafe deserialization of untrusted data. Use safe alternatives like JSON.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 57,
      "code_snippet": "obj = pickle.loads(data)",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-732",
      "severity": "medium",
      "title": "Incorrect Permission Assignment",
      "description": "Insecure file permissions: world-writable. Use restrictive permissions.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 80,
      "code_snippet": "os.chmod(temp_file, 0o777)",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-434",
      "severity": "high",
      "title": "Unrestricted File Upload",
      "description": "File upload without type validation. Restrict file types to whitelist only.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 78,
      "code_snippet": "f.write('sensitive data')",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 16,
      "code_snippet": "DATABASE_PASSWORD = \"supersecret123\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 17,
      "code_snippet": "API_KEY = \"sk-1234567890abcdefghijklmnop\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 17,
      "code_snippet": "API_KEY = \"sk-1234567890abcdefghijklmnop\"",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 20,
      "code_snippet": "@app.route('/user/<user_id>')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 30,
      "code_snippet": "@app.route('/search')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 38,
      "code_snippet": "@app.route('/ping')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 46,
      "code_snippet": "@app.route('/file/<filename>')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 53,
      "code_snippet": "@app.route('/load', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 66,
      "code_snippet": "@app.route('/fetch')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 53,
      "code_snippet": "@app.route('/load', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 75,
      "code_snippet": "def create_temp_file():",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-89",
      "severity": "critical",
      "title": "SQL Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before sql injection.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 26,
      "code_snippet": "    # Vulnerable: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE id = \" + user_id\n    cursor.execute(query)\n    return cursor.fetchone()\n",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-489",
      "severity": "critical",
      "title": "Debug Mode Enabled",
      "description": "Flask debug mode enables the interactive debugger, allowing arbitrary code execution.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 83,
      "code_snippet": "app.run(debug=True)",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-319",
      "severity": "medium",
      "title": "Missing HTTPS Configuration",
      "description": "Application runs without SSL/TLS configuration.",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 83,
      "code_snippet": "app.run(debug=True)",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "918",
      "severity": "high",
      "title": "Server-Side Request Forgery (SSRF)",
      "description": "Server-Side Request Forgery (SSRF)",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 220,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "732",
      "severity": "high",
      "title": "Incorrect Permission Assignment",
      "description": "Incorrect Permission Assignment",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 215,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "78",
      "severity": "high",
      "title": "Command Injection in ping Function",
      "description": "The `ping` function does not properly sanitize the user input for the `host` parameter. This allows an attacker to inject malicious commands into the `ping` command, leading to OS command injection.\n\n```python\n@app.route('/ping')\ndef ping():\n    host = request.args.get('host', 'localhost')\n    # Vulnerable: Passing user input to shell command\n    result = os.system(f\"ping -c 1 {host}\")\n    return str(result)\n```",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 110,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "22",
      "severity": "high",
      "title": "Path Traversal in read_file Function",
      "description": "The `read_file` function does not validate the user input for the `filename` parameter. This allows an attacker to traverse directories and access files outside of the expected directory structure.\n\n```python\n@app.route('/file/<filename>')\ndef read_file(filename):\n    # Vulnerable: No path validation\n    with open(filename, 'r') as f:\n        return f.read()\n```",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 130,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "502",
      "severity": "high",
      "title": "Unsafe Deserialization in load_data Function",
      "description": "The `load_data` function does not properly deserialize the user input. This allows an attacker to inject malicious data into the object, leading to unsafe deserialization.\n\n```python\n@app.route('/load', methods=['POST'])\ndef load_data():\n    data = request.data\n    # Vulnerable: Unpickling untrusted data\n    obj = pickle.loads(data)\n    return str(obj)\n```",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 148,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "798",
      "severity": "high",
      "title": "Hardcoded Credentials in ping Function",
      "description": "Hardcoded Credentials in ping Function",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 110,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "798",
      "severity": "high",
      "title": "Hardcoded Credentials",
      "description": "Hardcoded Credentials",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 12,
      "code_snippet": "from flask import Flask, request\n\napp = Flask(__name__)",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "89",
      "severity": "high",
      "title": "SQL Injection",
      "description": "SQL Injection",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 24,
      "code_snippet": "    cursor = conn.cursor()\n    # Vulnerable: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE id = \" + user_id",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "79",
      "severity": "high",
      "title": "Cross-Site Scripting (XSS)",
      "description": "Cross-Site Scripting (XSS)",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 32,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "79",
      "severity": "high",
      "title": "Path Traversal",
      "description": "Path Traversal",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 34,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    },
    {
      "cwe": "79",
      "severity": "high",
      "title": "LDAP/XML/NoSQL Injection",
      "description": "LDAP/XML/NoSQL Injection",
      "file_path": "examples/vulnerable_code.py",
      "line_number": 36,
      "code_snippet": "",
      "confidence": "high",
      "category": "security",
      "language": "unknown"
    }
  ]
}