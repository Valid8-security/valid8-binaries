{
  "scan_id": "ec6143379c75",
  "timestamp": "2025-11-15T04:41:27.812209",
  "target": "comprehensive_test/python/small",
  "summary": {
    "files_scanned": 7,
    "vulnerabilities_found": 22,
    "by_severity": {
      "high": 6,
      "critical": 14,
      "medium": 2
    },
    "by_cwe": {
      "CWE-639": 5,
      "CWE-78": 6,
      "CWE-89": 6,
      "CWE-327": 1,
      "CWE-502": 2,
      "CWE-489": 1,
      "CWE-319": 1
    }
  },
  "vulnerabilities": [
    {
      "cwe": "CWE-639",
      "severity": "high",
      "title": "Insecure Direct Object Reference",
      "description": "Resource access determined solely by user-supplied identifiers.",
      "file_path": "comprehensive_test/python/small/file_1.py",
      "line_number": 15,
      "code_snippet": "query = f\"SELECT * FROM users WHERE id = {user_id}\"",
      "confidence": "0.80",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "Command Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before command injection.",
      "file_path": "comprehensive_test/python/small/file_1.py",
      "line_number": 6,
      "code_snippet": "import subprocess\ncmd = input('Command: ')\nsubprocess.call(cmd, shell=True)\n\n# CWE-79: XSS",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-89",
      "severity": "critical",
      "title": "SQL Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before sql injection.",
      "file_path": "comprehensive_test/python/small/file_1.py",
      "line_number": 16,
      "code_snippet": "import sqlite3\nquery = f\"SELECT * FROM users WHERE id = {user_id}\"\ncursor.execute(query)\n\n// Clean function in python",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-639",
      "severity": "high",
      "title": "Insecure Direct Object Reference",
      "description": "Resource access determined solely by user-supplied identifiers.",
      "file_path": "comprehensive_test/python/small/file_4.py",
      "line_number": 15,
      "code_snippet": "query = f\"SELECT * FROM users WHERE id = {user_id}\"",
      "confidence": "0.80",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "Command Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before command injection.",
      "file_path": "comprehensive_test/python/small/file_4.py",
      "line_number": 6,
      "code_snippet": "import subprocess\ncmd = input('Command: ')\nsubprocess.call(cmd, shell=True)\n\n# CWE-79: XSS",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-89",
      "severity": "critical",
      "title": "SQL Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before sql injection.",
      "file_path": "comprehensive_test/python/small/file_4.py",
      "line_number": 16,
      "code_snippet": "import sqlite3\nquery = f\"SELECT * FROM users WHERE id = {user_id}\"\ncursor.execute(query)\n\n// Clean function in python",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-639",
      "severity": "high",
      "title": "Insecure Direct Object Reference",
      "description": "Resource access determined solely by user-supplied identifiers.",
      "file_path": "comprehensive_test/python/small/file_0.py",
      "line_number": 15,
      "code_snippet": "query = f\"SELECT * FROM users WHERE id = {user_id}\"",
      "confidence": "0.80",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "Command Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before command injection.",
      "file_path": "comprehensive_test/python/small/file_0.py",
      "line_number": 6,
      "code_snippet": "import subprocess\ncmd = input('Command: ')\nsubprocess.call(cmd, shell=True)\n\n# CWE-79: XSS",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-89",
      "severity": "critical",
      "title": "SQL Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before sql injection.",
      "file_path": "comprehensive_test/python/small/file_0.py",
      "line_number": 16,
      "code_snippet": "import sqlite3\nquery = f\"SELECT * FROM users WHERE id = {user_id}\"\ncursor.execute(query)\n\n// Clean function in python",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-327",
      "severity": "medium",
      "title": "Weak Cryptography",
      "description": "Use of weak or insecure cryptographic primitives.",
      "file_path": "comprehensive_test/python/small/vulnerable_app.py",
      "line_number": 67,
      "code_snippet": "hash_obj = hashlib.md5(data.encode())  # VULNERABLE - MD5 is weak",
      "confidence": "0.75",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-502",
      "severity": "critical",
      "title": "Unsafe Deserialization",
      "description": "Use of unsafe deserialization routines with untrusted data.",
      "file_path": "comprehensive_test/python/small/vulnerable_app.py",
      "line_number": 59,
      "code_snippet": "obj = pickle.loads(data.encode())  # VULNERABLE",
      "confidence": "0.85",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "Command Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before command injection.",
      "file_path": "comprehensive_test/python/small/vulnerable_app.py",
      "line_number": 25,
      "code_snippet": "    # CWE-78: Command Injection\n    cmd = request.args.get('cmd', 'ls')\n    result = subprocess.call(cmd, shell=True)  # VULNERABLE\n    return f\"Command executed: {cmd}\"\n",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-89",
      "severity": "critical",
      "title": "SQL Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before sql injection.",
      "file_path": "comprehensive_test/python/small/vulnerable_app.py",
      "line_number": 42,
      "code_snippet": "    cursor = conn.cursor()\n    query = f\"SELECT * FROM users WHERE username = '{username}'\"  # VULNERABLE\n    cursor.execute(query)\n    results = cursor.fetchall()\n    conn.close()",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-502",
      "severity": "high",
      "title": "Unsafe Deserialization",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before unsafe deserialization.",
      "file_path": "comprehensive_test/python/small/vulnerable_app.py",
      "line_number": 59,
      "code_snippet": "    # CWE-502: Insecure Deserialization\n    data = request.args.get('data', '')\n    obj = pickle.loads(data.encode())  # VULNERABLE\n    return str(obj)\n",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-489",
      "severity": "critical",
      "title": "Debug Mode Enabled",
      "description": "Flask debug mode enables the interactive debugger, allowing arbitrary code execution.",
      "file_path": "comprehensive_test/python/small/vulnerable_app.py",
      "line_number": 71,
      "code_snippet": "app.run(debug=True)",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-319",
      "severity": "medium",
      "title": "Missing HTTPS Configuration",
      "description": "Application runs without SSL/TLS configuration.",
      "file_path": "comprehensive_test/python/small/vulnerable_app.py",
      "line_number": 71,
      "code_snippet": "app.run(debug=True)",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-639",
      "severity": "high",
      "title": "Insecure Direct Object Reference",
      "description": "Resource access determined solely by user-supplied identifiers.",
      "file_path": "comprehensive_test/python/small/file_3.py",
      "line_number": 15,
      "code_snippet": "query = f\"SELECT * FROM users WHERE id = {user_id}\"",
      "confidence": "0.80",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "Command Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before command injection.",
      "file_path": "comprehensive_test/python/small/file_3.py",
      "line_number": 6,
      "code_snippet": "import subprocess\ncmd = input('Command: ')\nsubprocess.call(cmd, shell=True)\n\n# CWE-79: XSS",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-89",
      "severity": "critical",
      "title": "SQL Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before sql injection.",
      "file_path": "comprehensive_test/python/small/file_3.py",
      "line_number": 16,
      "code_snippet": "import sqlite3\nquery = f\"SELECT * FROM users WHERE id = {user_id}\"\ncursor.execute(query)\n\n// Clean function in python",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-639",
      "severity": "high",
      "title": "Insecure Direct Object Reference",
      "description": "Resource access determined solely by user-supplied identifiers.",
      "file_path": "comprehensive_test/python/small/file_2.py",
      "line_number": 15,
      "code_snippet": "query = f\"SELECT * FROM users WHERE id = {user_id}\"",
      "confidence": "0.80",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "Command Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before command injection.",
      "file_path": "comprehensive_test/python/small/file_2.py",
      "line_number": 6,
      "code_snippet": "import subprocess\ncmd = input('Command: ')\nsubprocess.call(cmd, shell=True)\n\n# CWE-79: XSS",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-89",
      "severity": "critical",
      "title": "SQL Injection",
      "description": "Tainted data from user input reaches dangerous sink without sanitization. Sanitize user input before sql injection.",
      "file_path": "comprehensive_test/python/small/file_2.py",
      "line_number": 16,
      "code_snippet": "import sqlite3\nquery = f\"SELECT * FROM users WHERE id = {user_id}\"\ncursor.execute(query)\n\n// Clean function in python",
      "confidence": "high",
      "category": "security",
      "language": "python"
    }
  ]
}