{
  "scan_id": "0c2cbd647fe4",
  "timestamp": "2025-11-06T17:27:53.705805",
  "target": "test_codebase",
  "summary": {
    "files_scanned": 101,
    "vulnerabilities_found": 17,
    "by_severity": {
      "high": 10,
      "medium": 2,
      "critical": 5
    },
    "by_cwe": {
      "CWE-89": 1,
      "CWE-327": 2,
      "CWE-287": 2,
      "CWE-78": 2,
      "CWE-798": 2,
      "CWE-259": 1,
      "CWE-311": 2,
      "CWE-352": 2,
      "CWE-502": 1,
      "CWE-95": 1,
      "CWE-79": 1
    }
  },
  "vulnerabilities": [
    {
      "cwe": "CWE-89",
      "severity": "high",
      "title": "SQL Injection",
      "description": "Potential SQL injection. Use parameterized queries with placeholders.",
      "file_path": "test_codebase/go/sql_injection.go",
      "line_number": 10,
      "code_snippet": "query := fmt.Sprintf(\"SELECT * FROM users WHERE username = '%s'\", username)",
      "confidence": "high",
      "category": "security",
      "language": "go"
    },
    {
      "cwe": "CWE-327",
      "severity": "medium",
      "title": "Weak Cryptographic Algorithm",
      "description": "Use of weak cryptographic algorithm MD5. Use SHA-256 or stronger.",
      "file_path": "test_codebase/python/weak_crypto.py",
      "line_number": 5,
      "code_snippet": "return hashlib.md5(password.encode()).hexdigest()",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "test_codebase/python/xss_vuln.py",
      "line_number": 5,
      "code_snippet": "@app.route('/search')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "OS Command Injection",
      "description": "Potential command injection using os.system. User input should never be passed directly to system commands.",
      "file_path": "test_codebase/python/command_injection.py",
      "line_number": 6,
      "code_snippet": "os.system(f\"ls -la {user_cmd}\")",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-798",
      "severity": "critical",
      "title": "Hardcoded Credentials",
      "description": "Hardcoded password detected. Store credentials in environment variables.",
      "file_path": "test_codebase/python/hardcoded_creds.py",
      "line_number": 2,
      "code_snippet": "DB_PASSWORD = \"admin123\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-798",
      "severity": "critical",
      "title": "Hardcoded Credentials",
      "description": "Hardcoded API key detected. Store credentials in environment variables.",
      "file_path": "test_codebase/python/hardcoded_creds.py",
      "line_number": 3,
      "code_snippet": "API_KEY = \"sk-1234567890abcdef\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-259",
      "severity": "critical",
      "title": "Hard-coded Password",
      "description": "Environment password. Store passwords securely, never hard-code them.",
      "file_path": "test_codebase/python/hardcoded_creds.py",
      "line_number": 2,
      "code_snippet": "DB_PASSWORD = \"admin123\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "test_codebase/python/hardcoded_creds.py",
      "line_number": 2,
      "code_snippet": "DB_PASSWORD = \"admin123\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "test_codebase/python/hardcoded_creds.py",
      "line_number": 3,
      "code_snippet": "API_KEY = \"sk-1234567890abcdef\"",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "test_codebase/python/hardcoded_creds.py",
      "line_number": 3,
      "code_snippet": "API_KEY = \"sk-1234567890abcdef\"",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "test_codebase/java/sql_injection.java",
      "line_number": 8,
      "code_snippet": "Statement stmt = conn.createStatement();",
      "confidence": "medium",
      "category": "security",
      "language": "java"
    },
    {
      "cwe": "CWE-327",
      "severity": "medium",
      "title": "Weak Cryptographic Algorithm",
      "description": "Use of weak algorithm MD5. Use AES-256 or SHA-256.",
      "file_path": "test_codebase/java/weak_crypto.java",
      "line_number": 7,
      "code_snippet": "MessageDigest md = MessageDigest.getInstance(\"MD5\");",
      "confidence": "high",
      "category": "security",
      "language": "java"
    },
    {
      "cwe": "CWE-502",
      "severity": "high",
      "title": "Unsafe Deserialization",
      "description": "Unsafe deserialization of untrusted data. Validate input first.",
      "file_path": "test_codebase/javascript/unsafe_eval.js",
      "line_number": 3,
      "code_snippet": "eval(code);",
      "confidence": "high",
      "category": "security",
      "language": "javascript"
    },
    {
      "cwe": "CWE-95",
      "severity": "high",
      "title": "Dangerous Function Usage",
      "description": "Use of dangerous function: eval. Avoid dynamic code execution.",
      "file_path": "test_codebase/javascript/unsafe_eval.js",
      "line_number": 3,
      "code_snippet": "eval(code);",
      "confidence": "high",
      "category": "security",
      "language": "javascript"
    },
    {
      "cwe": "CWE-79",
      "severity": "high",
      "title": "Cross-Site Scripting (XSS)",
      "description": "Potential XSS. Sanitize user input or use textContent.",
      "file_path": "test_codebase/javascript/innerHTML_vuln.js",
      "line_number": 3,
      "code_snippet": "document.getElementById('content').innerHTML = data;",
      "confidence": "high",
      "category": "security",
      "language": "javascript"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "test_codebase/javascript/innerHTML_vuln.js",
      "line_number": 1,
      "code_snippet": "function updateContent(data) {",
      "confidence": "medium",
      "category": "security",
      "language": "javascript"
    },
    {
      "cwe": "CWE-78",
      "severity": "critical",
      "title": "OS Command Injection",
      "description": "Command injection via system. Use array form or Open3.capture3.",
      "file_path": "test_codebase/ruby/command_injection.rb",
      "line_number": 3,
      "code_snippet": "system(\"ls #{cmd}\")",
      "confidence": "high",
      "category": "security",
      "language": "ruby"
    }
  ]
}