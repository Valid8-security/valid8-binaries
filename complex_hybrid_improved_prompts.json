{
  "scan_id": "87abfac0860c",
  "timestamp": "2025-11-04T06:14:39.529515",
  "target": "examples/vulnerable_complex.py",
  "summary": {
    "files_scanned": 1,
    "vulnerabilities_found": 44,
    "by_severity": {
      "high": 39,
      "critical": 3,
      "medium": 2
    },
    "by_cwe": {
      "CWE-89": 1,
      "CWE-306": 1,
      "CWE-434": 1,
      "CWE-330": 1,
      "CWE-311": 2,
      "CWE-287": 17,
      "CWE-352": 17,
      "CWE-327": 1,
      "CWE-798": 1,
      "CWE-489": 1,
      "CWE-319": 1
    }
  },
  "vulnerabilities": [
    {
      "cwe": "CWE-89",
      "severity": "high",
      "title": "SQL Injection",
      "description": "Potential SQL injection. Use parameterized queries instead of string formatting.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 26,
      "code_snippet": "db.execute(\"UPDATE accounts SET balance = balance + ? WHERE id = ?\", (amount, to_account))",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-306",
      "severity": "critical",
      "title": "Missing Authentication",
      "description": "Critical function \"delete\" has no authentication. Add @login_required or similar decorator.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 302,
      "code_snippet": "def delete_document(doc_id):",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-434",
      "severity": "high",
      "title": "Unrestricted File Upload",
      "description": "File upload without type validation. Restrict file types to whitelist only.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 51,
      "code_snippet": "product.save()",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-330",
      "severity": "medium",
      "title": "Insufficient Random Values",
      "description": "Use random.choice()/randint() for cryptographic operations. Use secrets module instead.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 141,
      "code_snippet": "token = str(random.randint(100000, 999999))",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 156,
      "code_snippet": "password = request.form.get('password')",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-311",
      "severity": "high",
      "title": "Missing Encryption of Sensitive Data",
      "description": "Sensitive data stored without encryption. Encrypt at rest and in transit.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 287,
      "code_snippet": "password = request.json.get('password')",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 16,
      "code_snippet": "@app.route('/transfer', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 31,
      "code_snippet": "@app.route('/admin/users')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 40,
      "code_snippet": "@app.route('/update_price', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 58,
      "code_snippet": "@app.route('/comment', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 70,
      "code_snippet": "@app.route('/comments')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 91,
      "code_snippet": "@app.route('/download/<username>')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 107,
      "code_snippet": "@app.route('/withdraw', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 150,
      "code_snippet": "@app.route('/login', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 174,
      "code_snippet": "@app.route('/api/user/<user_id>')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 175,
      "code_snippet": "def get_user_api(user_id):",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 196,
      "code_snippet": "@app.route('/search')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 215,
      "code_snippet": "@app.route('/checkout', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 242,
      "code_snippet": "@app.route('/api/token')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 264,
      "code_snippet": "@app.route('/preview')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 281,
      "code_snippet": "@app.route('/api/login', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 282,
      "code_snippet": "def api_login():",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-287",
      "severity": "high",
      "title": "Improper Authentication",
      "description": "Endpoint without authentication. Implement proper authentication mechanisms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 301,
      "code_snippet": "@app.route('/document/<doc_id>/delete', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 16,
      "code_snippet": "@app.route('/transfer', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 25,
      "code_snippet": "db.execute(\"UPDATE accounts SET balance = balance - ? WHERE id = ?\", (amount, from_account))",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 26,
      "code_snippet": "db.execute(\"UPDATE accounts SET balance = balance + ? WHERE id = ?\", (amount, to_account))",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 40,
      "code_snippet": "@app.route('/update_price', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 41,
      "code_snippet": "def update_price():",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 53,
      "code_snippet": "return \"Updated\"",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 58,
      "code_snippet": "@app.route('/comment', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 107,
      "code_snippet": "@app.route('/withdraw', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 124,
      "code_snippet": "db.execute(\"UPDATE accounts SET balance = ? WHERE user_id = ?\", (new_balance, user_id))",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 150,
      "code_snippet": "@app.route('/login', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 215,
      "code_snippet": "@app.route('/checkout', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 243,
      "code_snippet": "def create_token():",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 281,
      "code_snippet": "@app.route('/api/login', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "POST endpoint without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 301,
      "code_snippet": "@app.route('/document/<doc_id>/delete', methods=['POST'])",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 302,
      "code_snippet": "def delete_document(doc_id):",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 316,
      "code_snippet": "db.execute(\"DELETE FROM documents WHERE id = ?\", (doc_id,))",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-352",
      "severity": "high",
      "title": "Cross-Site Request Forgery (CSRF)",
      "description": "State-changing operation without CSRF protection. Implement CSRF tokens for state-changing operations.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 318,
      "code_snippet": "return \"Deleted\"",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-327",
      "severity": "high",
      "title": "Weak JWT Algorithm",
      "description": "Using weak JWT algorithm (HS256 or none). Use RS256 or stronger algorithms.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 253,
      "code_snippet": "token = jwt.encode(",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-798",
      "severity": "critical",
      "title": "Hardcoded Secret Key",
      "description": "Flask secret_key is hardcoded. This key is used for session signing.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 12,
      "code_snippet": "app.secret_key = \"dev\"  # Weak secret in productio...",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-489",
      "severity": "critical",
      "title": "Debug Mode Enabled",
      "description": "Flask debug mode enables the interactive debugger, allowing arbitrary code execution.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 323,
      "code_snippet": "app.run(debug=True, host='0.0.0.0')",
      "confidence": "high",
      "category": "security",
      "language": "python"
    },
    {
      "cwe": "CWE-319",
      "severity": "medium",
      "title": "Missing HTTPS Configuration",
      "description": "Application runs without SSL/TLS configuration.",
      "file_path": "examples/vulnerable_complex.py",
      "line_number": 323,
      "code_snippet": "app.run(debug=True, host='0.0.0.0')",
      "confidence": "medium",
      "category": "security",
      "language": "python"
    }
  ]
}